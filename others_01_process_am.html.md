# Process AlphaMissense dataset


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
import pandas as pd
```

Uncheck below to download the AlphaMissense data:

``` python
# !wget https://zenodo.org/records/8208688/files/AlphaMissense_aa_substitutions.tsv.gz
```

``` python
df = pd.read_csv('AlphaMissense_aa_substitutions.tsv.gz', compression='gzip',  header=3, sep='\t', quotechar='"')
```

    CPU times: user 1min 2s, sys: 37.8 s, total: 1min 39s
    Wall time: 3min 6s

``` python
df['position'] = df.protein_variant.str[1:-1].astype(int)
```

``` python
df['aa_position'] =  df.protein_variant.str[:-1]
```

``` python
df_mean = df.groupby(['uniprot_id','aa_position'])['am_pathogenicity'].mean().reset_index()
```

``` python
df.shape[0]//df_mean.shape[0]
```

    19

``` python
df_mean['position'] = df_mean.aa_position.str[1:].astype(int)
```

``` python
df_mean = df_mean.sort_values(by=['uniprot_id','position']).reset_index(drop=True)
```

``` python
df_mean.to_parquet('raw/AM_mean.parquet')
```

``` python
df_mean
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">uniprot_id</th>
<th data-quarto-table-cell-role="th">aa_position</th>
<th data-quarto-table-cell-role="th">am_pathogenicity</th>
<th data-quarto-table-cell-role="th">position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0A024R1R8</td>
<td>M1</td>
<td>0.414942</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A0A024R1R8</td>
<td>S2</td>
<td>0.231174</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A0A024R1R8</td>
<td>S3</td>
<td>0.188332</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A0A024R1R8</td>
<td>H4</td>
<td>0.141832</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>A0A024R1R8</td>
<td>E5</td>
<td>0.245732</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11377646</td>
<td>X6R8D5</td>
<td>V123</td>
<td>0.296089</td>
<td>123</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11377647</td>
<td>X6R8D5</td>
<td>L124</td>
<td>0.260532</td>
<td>124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11377648</td>
<td>X6R8D5</td>
<td>W125</td>
<td>0.901605</td>
<td>125</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11377649</td>
<td>X6R8D5</td>
<td>R126</td>
<td>0.326921</td>
<td>126</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11377650</td>
<td>X6R8D5</td>
<td>S127</td>
<td>0.407611</td>
<td>127</td>
</tr>
</tbody>
</table>

<p>11377651 rows Ã— 4 columns</p>
</div>
